<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Java、分布式、大数据、微服务、机器学习"><title> | Coselding</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Coselding</h1><a id="logo" href="/.">Coselding</a><p class="description">非淡泊无以明志，非宁静无以致远。</p></div><div id="nav-menu"><a href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/tags/"><i class="fa fa-tags"> 标签</i></a><a href="/links/"><i class="fa fa-link"> 链接</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title"></h1><div class="post-content"><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MyBatis源码浅析</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 引入 Bootstrap -->
    <link href="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <!-- HTML5 Shim 和 Respond.js 用于让 IE8 支持 HTML5元素和媒体查询 -->
    <!-- 注意： 如果通过 file://  引入 Respond.js 文件，则该文件无法起效果 -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
    <!-- jQuery (Bootstrap 的 JavaScript 插件需要引入 jQuery) -->
    <script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
    <!-- 包括所有已编译的插件 -->
    <script src="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <link href="/css/style.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-default" role="navigation">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#example-navbar-collapse">
            <span class="sr-only">切换导航</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <div class="navbar-brand"></div>
        <img src="/logo.jpg" style="border-radius:25px;" width="50px" height="50px">&nbsp;&nbsp;
        <a class="title-text nav-title" style="color: #e38d13" href="/public/contact.html">Coselding</a>
    </div>
    <div class="collapse navbar-collapse" id="example-navbar-collapse">
        <ul class="nav navbar-nav navbar-right" id="menu-click">
            <li class="active"><a href="/Coselding-old/">旧版入口>></a></li>
            <li><a href="/list">所有文章</a></li>
            <li><a href="https://github.com/Coselding" target="_blank" rel="external">Github</a></li>
            <li><a href="http://blog.csdn.net/u014394255" target="_blank" rel="external">CSDN博客</a></li>
            <li><a href="/comment/">留言板</a></li>
            <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                    Menu<b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                    <li><a href="/s/">短网址</a></li>
                    <li><a href="/WordUpload/">作业提交系统</a></li>
                    <li class="divider"></li>
                    <li><a href="/public/contact.html">关于我</a></li>
                </ul>
            </li>
        </ul>
    </div>
</nav>

<div class="container">
    <div class="container-fluid">
        <h1 class="collection-header" id="sub-title"><span>非淡泊无以明志，非宁静无以致远。</span></h1>
        <div class="collection-info">
            <span class="meta-info mobile-hidden">
                <span class="glyphicon glyphicon-map-marker"></span>
                福建漳州
            </span>&nbsp;&nbsp;
            <span class="meta-info">
                <span class="glyphicon glyphicon-tag"></span>
                Java Developer
            </span>&nbsp;&nbsp;
            <span class="meta-info">
                <span class="glyphicon glyphicon-user"></span>
                <a href="/public/contact.html" target="_blank">林宇强</a>
            </span>&nbsp;&nbsp;
            <span class="meta-info">
                <span class="glyphicon glyphicon-link"></span>
                <a href="https://github.com/Coselding" target="_blank">Github</a>
            </span>
        </div>
    </div>
</div>

<div class="container">
    <div class="clearfix">
        <div class="col-md-8 column">
            <h3 class="text-left text-primary"></h3>
        </div>
    </div>
</div>

<div class="container">
    <div class="row clearfix">
        <div class="col-md-9 column">
            <div class="panel panel-default">
                <div class="panel-body">
                    <h2 class="panel-title text-left">
                        <a href="/list?cid=8" title="框架相关">
                        框架相关
                        </a>
                        &gt;&gt;
                        MyBatis源码浅析
                    </h2>
                </div>
                <div class="panel-body">
                    <h2 class="panel-title text-center">MyBatis源码浅析</h2>
                </div>

                <div class="panel-body">
                    <div class="text-center">
                        <a href="/list?cid=8" title="查看该标签文章">
                            <span class="glyphicon glyphicon-tags"></span> 框架相关
                        </a>
                        &nbsp;&nbsp;
                        <a href="#">
                            <span class="glyphicon glyphicon-user"></span> Coselding
                        </a>
                        &nbsp;&nbsp;
                        <span class="glyphicon glyphicon-time"></span> 2016-06-09 08:13
                    </div>
                </div>

                <div class="panel-body">
                <p>本文为博主原创，允许转载，但请声明原文地址：<a href="http://www.coselding.cn/article/2016-06-09/-1151499729.html" target="_blank" rel="external">http://www.coselding.cn/article/2016-06-09/-1151499729.html</a></p>
                <p><span style="font-family:微软雅黑;">MyBatis源码浅析<br> 我们来从使用过程的角度来看源码~</span></p> 
<p><span style="font-family:微软雅黑;">注：本人已经熟练掌握JDBC编程的各个细节，并且有Hibernate开发经验，对Hibernate的一些细节较为熟悉，所以过程中不免会因此忽略一些细节，有的话再给我指出即可。。。</span></p> 
<p><span style="font-family:微软雅黑;">Mybatis版本为3.3.1</span></p> 
<p><span style="font-family:微软雅黑;">1、&nbsp;首先通过一个xml的配置文件的Reader对象来实例化一个SqlSessionFactory，过程如下：<br> SqlSessionFactoryBuilder().build(reader)<br> 点进去build方法，发现里面一大堆的重载方法，最终结果是把传入的代表主配置文件的对象转换成XMLConfigBuilder，其构造方法主要包括三个参数，如下：<br> &nbsp;<img alt="" src="/upload/images/91f837a0-e1e0-429f-8bb1-af4f16c576a6_.png" style="; ;" width="100%" height=""><br> reader：xml主配置文件的Reader对象<br> environment：主配置文件environments节点下可以配置多个environment，这个参数用来指定要加载哪个environment，不指定话他会加载默认的配置，这里还没深究<br> properties：properties配置文件加载到内存后的对象</span></p> 
<p><span style="font-family:微软雅黑;">接下来呢，他会把刚才的xml文件解析成Document（显而易见），把Document和Properties对象存在XPathParser，作为XMLConfigBuilder的构造参数，XMLConfigBuilder里面保存了个标记位parsed，用来标记XMLConfigBuilder是否解析过了（很显而易见的设计方式），其中的parse方法把构造XMLConfigBuilder的那些对象封装成一个Configuration对象，看看Configuration对象内部，也不太需要看得太仔细，内部内容就是对配置文件的配置参数的集合，并提供了相应的set和get方法，之后的框架需要的配置参数就从他这边获得。</span></p> 
<p><span style="font-family:微软雅黑;">刚才讲的都是主配置文件，在主配置文件中可以找到&lt;mappers/&gt;节点，通过该节点可以找到各个实体的映射配置文件，和主配置文件一样的道理，读取这个映射配置文件，里面配置了对这个实体的各种操作的sql语句（select、insert、delete、update四种节点），每个把他提取出来，封装成MapperStatement，映射文件还配置了&lt;resultMap/&gt;节点，这些节点封装成ResultMap对象。</span></p> 
<p><span style="font-family:微软雅黑;">简要说一下这两个类中的字段：<br> MapperStatement：id、主键相关、sql命令类型（增删改查等类型）、结果集、缓存、参数映射、结果集映射、超时时间等等<br> ResultMap：id、要映射的JavaBean类、&lt;resultMap/&gt;四种子节点对应的List、数据库列集合、自动映射符号位等等<br> ParameterMap：id、参数映射对应的JavaBean类、JavaBean类中的属性和数据库列的映射列表</span></p> 
<p><span style="font-family:微软雅黑;">总结：把配置文件加载成Configuration、MapperStatement、ResultMap对象服务于后续的框架使用。<br> 通过这些对象就可以得到配置文件的所有信息。</span></p> 
<p><span style="font-family:微软雅黑;">2、&nbsp;返回SqlSessionFactoryBuilder类，最下面使用上面生成的Configuration对象创建了SqlSessionFactory接口的默认实现DefaultSqlSessionFactory，来看看DefaultSqlSessionFactory这个类内部干嘛的，如下：<br> 好多个openSession的相关重载，但是都是统一调用了openSessionFromDataSource和openSessionFromConnection，下面看看这两个方法：<br> openSessionFromDataSource（从名字显而易见，从数据源获取Session对象）：<br> &nbsp;<img alt="" src="/upload/images/230d46f5-7906-4ec9-8c99-a684adade55f_.png" style="; ;" width="100%" height=""><br> （1）&nbsp;Transaction对象：事务对象，TransactionFactory开启事务返回的事务对象，封装了数据库连接对象，事务的提交、回滚等方法<br> （2）&nbsp;Environment：刚才说了，那个environment参数指定了主配置文件加载哪个数据源配置，在这里他就把加载的配置封装成一个对象了，里面包含了数据源对象和TransactionFactory<br> &nbsp;<img alt="" src="/upload/images/b91909d2-f90f-4eb3-a100-07353987b68c_.png" style="; ;" width="100%" height=""><br> （3）&nbsp;TransactionFactory：事务工厂，封装了数据库事务的相关方法，事务隔离级别等，这个在使用JDBC的Connection对象的时候也有的功能，这里进行了封装，和Environment对象绑定，其中的autoCommit参数就是JDBC设置自动提交的参数（事务）<br> （4）&nbsp;Executor：执行器，SQL执行的核心类；<br> 通过Configuration对象和事务对象创建执行器，并在拦截器链中的每个拦截器都注册一遍，才是真正完成了执行器对象的创建；</span></p> 
<p><span style="font-family:微软雅黑;">（5）&nbsp;DefaultSqlSession：和Hibernate类似的SqlSession对象，通过Configuration、执行器和autoCommit创建SqlSession对象；<br> &nbsp;<img alt="" src="/upload/images/c5fe0b37-05ab-46a0-93cd-9415dab338c7_.png" style="; ;" width="100%" height=""><br> executor对象包含了事务对象，连接对象<br> （6）&nbsp;ExecutorType：枚举，三个值：SIMPLE（简单执行器，用完释放），REUSE（这个执行器保存在List中，之后可以再拿来重复利用），BATCH（批处理）；<br> 这里呢，是根据这个类型去实例化相应的执行器（都是BaseExecutor的子类）<br> &nbsp;<img alt="" src="/upload/images/3fd7fae0-be22-4532-9c27-30c3f22b0d32_.png" style="; ;" width="100%" height=""><br> &nbsp;openSessionFromConnection（从数据库连接对象创建SqlSession）：和从数据源创建类似，只是少了从数据源中申请连接对象的过程。<br> <img alt="" src="/upload/images/0c0d5501-2e8f-4729-ab00-68b7f326913d_.png" style="; ;" width="100%" height=""></span></p> 
<p><span style="font-family:微软雅黑;">总结：里面的类封装了好多层，也有好多设计模式，抽象类，实现延迟，装饰模式，继承多态等各种高大上哈哈哈，源码看多了就习惯了<br> 总体过程呢，就是通过主配置文件得到的Configuration对象得到的连接池对象申请连接，并开启事务，得到一个SqlSession对象，这个对象封装了刚才申请的资源，通过这些连接、事务等资源对象来对数据库发送SQL命令（当然，SQL是在映射配置文件中的），总体过程就是申请好连接和事务，然后返回一个封装好的总体接口。。。</span></p> 
<p><span style="font-family:微软雅黑;">3、&nbsp;SqlSession对象的使用：（主要两种用法）<br> （1）&nbsp;getMapper：通过传入一个实体的操作接口的class（这个接口我们只需要定义，不需要实现），返回这个接口的一个实现，接口中的方法是和映射配置文件的SQL操作id一一对应的；<br> &nbsp;<img alt="" src="/upload/images/6d421cbb-414c-4a9f-a068-b873f6d7295d_.png" style="; ;" width="100%" height=""><br> 点进去看啊，发现是直接调用Configuration的方法（这个对象水真深啊，之后有空返回来再好好研究它），再一直点进去，结果也是意料之中的，动态代理，他帮我们实现了我们定义的这个实体操作接口的实现类，把映射配置文件中的对应id的SQL操作封装进去了呗，原理很简单（合成Java源码动态编译），不去仔细看了。。。<br> 要注意的一点是，他在中间多做了一个小动作，就是针对这个传入的class接口对象和动态合成的实现类用一个Map映射，其实就是缓存，万一这个class多次传入调用，每次都要动态编译，影响性能对吧。。。</span></p> 
<p><span style="font-family:微软雅黑;">这种调用方式是通过SqlSession得到一个实体操作类，之后调用这个实体就能直接操纵数据库了。<br> （2）&nbsp;另一种：直接使用SqlSession的select、insert、delete、update方法来完成数据库操纵，其中里面有大量重载啊，select归结起来最后都调用了同一个select方法，而另外的insert、delete、update到最后都是调用同一个update方法，下面来仔细看看这两个方法：<br> Select：<br> &nbsp;<img alt="" src="/upload/images/516e647a-d8a5-4f1e-8ecb-115ba3a61088_.png" style="; ;" width="100%" height=""><br> 第一步：通过id从Configuration对象查找MapperStatement对象（封装了映射配置文件中的一个SQL操作的节点信息），通过这个对象唯一确定要执行的SQL语句；<br> &nbsp;&nbsp;还有个parameter：这个Object对象一开始不是很懂啊，但是他调用了一个wrapCollection方法，瞬间豁然开朗，这个Object其实是可能是一个值，也可能是一个数组或一个集合等等，那从他的名称就知道了，这个对象其实就是SQL语句中的占位符所要替换的那些参数，没理解的话联想一下PreparedStatement；</span></p> 
<p><span style="font-family:微软雅黑;">接下来就调用了executor的query方法啦，传入了四个参数，说明一下：<br> MappedStatement：要对应的SQL执行操作嘛，上面讲过了；<br> Object：wrapCollection的返回值，是把原来的Object解析完成之后的了；<br> RowBounds：查询操作行数范围，默认0~Integer的最大值，应该是和SQL的limit限定有关的；<br> ResultHandler：结果集处理器，明显是查询操作后的结果集在这里面处理，并返回相应的JavaBean或者JavaBeanList对象；</span></p> 
<p><span style="font-family:微软雅黑;">点进去看看executor到底怎么执行的：（此处是接口，我们看SimpleExecutor的过程为例）<br> SimpleExecutor只是实现了BaseExecutor没实现的方法（延迟到子类实现，但是调用是在父类，策略设计模式），所以还得点进去看BaseExecutor（不过这个样我们看的过程就是所有执行器的统一过程了）<br> &nbsp;<img alt="" src="/upload/images/df8f15f4-b7f8-465d-909a-838d8015b362_.png" style="; ;" width="100%" height=""><br> 创建一级查询缓存key，这个必须唯一，createCacheKey方法里面一堆的运算，反正就是要通过这个几个对象创建一个唯一的key对象，不深究了。。。<br> 创建好key调用另一个query方法真正执行：<br> &nbsp;&nbsp;<img alt="" src="/upload/images/8f32e5fc-4c43-4224-8924-a60932e2cf53_.png" style="; ;" width="100%" height=""><br> &nbsp;&nbsp;过程简单讲就是先查一级缓存，找到的话直接返回，找不到再调用queryFromDatabase向数据库发送请求，接下来queryFromDatabase：<br> &nbsp;<img alt="" src="/upload/images/416a83db-1498-4297-80e4-0efb5c50eb9e_.png" style="; ;" width="100%" height=""><br> 先在localCache申请（我跟你预订了一个位置，给我留着），然后调用子类才实现的doQuery方法，最后再把真正的查询结果放到预定的缓存位置。<br> 然后就是看子类的doQuery具体实现了，SimpleExecutor为例：<br> &nbsp;<img alt="" src="/upload/images/b8694310-9280-4fa3-b62f-2a809a442900_.png" style="; ;" width="100%" height=""><br> 先通过Configuration得到一个StatementHandler对象，在通过这个对象得到Statement对象，然后执行相应的执行方法，现在进去StatementHandler看看具体的操作过程：<br> &nbsp;<img alt="" src="/upload/images/b4911ede-c278-491b-8de3-d4c26a2de977_.png" style="; ;" width="100%" height=""><br> 在Configuration中创建一个包装类RoutingStatementHandler，然后在拦截器链interceptorChain执行一遍（万一拦截器要拦截。。。），进RoutingStatementHandler：<br> &nbsp;<img alt="" src="/upload/images/d9b62ddd-b4a4-4663-a1f2-a16888d81a32_.png" style="; ;" width="100%" height=""><br> 根据映射配置文件配置的SQL类型，分别创建Statement、PreparedStatement或CallableStatement（存储过程）的Handler，作为这个包装类的委托，可以分别到这三个类中去看个究竟，但是意义不大了，就是把很常见的JDBC操作进行了一步步的封装，这个封装的目的得根据整个架构的设计来考量，这里仅仅粗略学习一下，暂不深究。。。<br> 里面有大量的异常处理，资源管理（连接对象、缓存等等）</span></p> 
<p><span style="font-family:微软雅黑;">但是，JDBC操作没什么好看的，有一点需要看看，ResultSetHandler是如何把查询结果集封装成JavaBean的？（显而易见是反射或者内省，不过，还是进去看看），见下面的结果集处理。</span></p> 
<p><span style="font-family:微软雅黑;">Update：增删改都调用这个方法，同样的，点进去BaseExecutor的update方法：<br> &nbsp;<img alt="" src="/upload/images/f4add84f-4e50-4908-9458-69c494008e35_.png" style="; ;" width="100%" height=""><br> 清空了下缓存，直接调用子类的doUpdate，看SimpleExecutor的：<br> &nbsp;<img alt="" src="/upload/images/06793b5e-894e-46d4-9274-26cbc6d5d386_.png" style="; ;" width="100%" height=""><br> 呵呵，和Select的过程是一样的，只是这里传入的ResultSerHandler为null，因为不需要。。。</span></p> 
<p><span style="font-family:微软雅黑;">4、&nbsp;结果集处理：<br> 按照参考的博客说的，Mybatis对Java的反射进行了进一步的封装，把那些没法处理的异常进行了封装和处理，简化了Mybatis对反射的使用。<br> 结果集处理主要涉及的类有：DefaultResultSetHandler，DefaultResultHandler，ResultSetWrapper，ResultMap，还有一系列数据库元数据，Mybatis全局对象等。<br> ResultSetWrapper：对ResultSet的包装类，包装了数据表的元数据（列名、列类型、Class名、映射等）；<br> ResultMap：前面说了，映射配置文件读取到的&lt;resultMap/&gt;节点的对应Java对象；<br> DefaultResultSetHandler：对结果集的处理，大致过程就是循环结果集的每行，分别调用DefaultResultHandler去执行，在添加到List中；<br> DefaultResultHandler：将数据库查询得到的行封装到JavaBean或Map数据结构中，以下简略说明执行过程：<br> 从DefaultResultSetHandler 的handleResultSets方法逐步深入去找，<br> &nbsp;<img alt="" src="/upload/images/f748a1c8-d0fa-49bd-a7f5-c3ccf1b71356_.png" style="; ;" width="100%" height=""><br> 分两种：一种普通类型，一种JavaBean中的一个属性是另一个JavaBean，resultMap嵌套嘛，仅分析第一种：<br> &nbsp;<img alt="" src="/upload/images/1a4698fa-18d8-43e9-86d4-ec0c7c1190fa_.png" style="; ;" width="100%" height=""><br> 超出rowBounds范围的行忽略；<br> While遍历每行，先获取ResultMap映射对象；<br> getRowValue：应该就是把行通过映射转换成JavaBean，返回Object，点进去看看<br> &nbsp;&nbsp;<img alt="" src="/upload/images/ffc268d2-fa74-432d-b1dd-f540c404afe9_.png" style="; ;" width="100%" height=""><br> createResultObject创建了JavaBean对象，进去看看，发现又有一层，再点进去：<br> &nbsp;<img alt="" src="/upload/images/1f936646-cf0c-4b29-a1a5-b96c1991aa80_.png" style="; ;" width="100%" height=""><br> 这里resultMap.getType应该就是得到配置文件&lt;resultMap/&gt;的type属性了，即JavaBean的Class对象，就是根据这个创建JavaBean类对象，到这里先停，这个方法应该就是创建这个JavaBean对象并根据ResultMap的配置进行该对象的一些初始化，我们返回，先不深究。。。<br> &nbsp;<img alt="" src="/upload/images/a11eff09-4a6a-4ba1-9edf-6c4d6ec384e7_.png" style="; ;" width="100%" height=""><br> 退到这，Mybatis用JavaBean对象创建了一个代理对象，很好理解，这个是为了一对多相关关系的延迟加载的功能。（代理对象实现过程就不深究了，无外乎动态代理，或者自定义一些优化）<br> 还是回到这里：<br> &nbsp;<img alt="" src="/upload/images/7a4207b8-72e1-47b5-b39d-71f2babb28ac_.png" style="; ;" width="100%" height=""><br> 用resultObjcet创建一个MetaObject，看看MetaObject：<br> &nbsp;<img alt="" src="/upload/images/6cf4289e-1167-499f-bb8e-e430a8409e48_.png" style="; ;" width="100%" height=""><br> 反射工厂，就是这里了，看来将ResultSet中的行反射到JavaBean就是在这里了。<br> 再回过头来看getRowValue方法中的：</span></p> 
<p><span style="font-family:微软雅黑;"><img alt="" src="/upload/images/5a918396-3a9c-4cba-9158-5cfaf9ce4070_.png" style="; ;" width="100%" height=""><br> rsw：ResultSetWrapper，ResultSet的包装类<br> resultMap：映射配置文件中的对应的映射对象<br> metaObject：这个包含了要填充的JavaBean对象<br> lazyLoader：需要延迟加载的ResultMap部分<br> 通过这些参数，可以很清楚的知道，这个方法，就是根据resultMap映射，把rsw中的数据库查询到的数据通过反射注入到metaObject的JavaBean对象中，延迟加载的对象先不执行。</span></p> 
<p><span style="font-family:微软雅黑;">主要过程大概这样，具体细节先不深究了，水很深。。。你如果点进去细细看每个细节，就会发现各种封装，各种设计模式，现在先做个大概吧，以后真的需要深究的时候，再好好品味。。。</span></p> 
<p><span style="font-family:微软雅黑;">总结：<br> （1）&nbsp;Mybatis没有完全实现对象关系映射，没有像Hibernate完整实现ORM框架，但是他轻量级地实现了对数据库操纵的简化，在某些方面甚至效率高于Hibernate；<br> （2）&nbsp;Mybatis和一般的ORM框架一样实现了基本的功能：一二级缓存、SQL与代码分离、延迟加载、连接池、简单的事务管理、Statement对象维护和重用、批处理、存储过程等基本功能；<br> （3）&nbsp;如果你非常熟悉JDBC编程，其实理解这个框架还是很容易的，最基本的理解透彻，以他为基础的延伸都很好掌握；<br> （4）&nbsp;如果有Hibernate使用和开发经验，也有助于掌握Mybatis，轻而易举。。。<br> （5）&nbsp;再总结一下整个过程：首先从连接池获取一个连接对象，然后开启事务，创建一个事务对象，通过id查询映射配置文件中的SQL操作节点，通过该节点信息和传入的占位符替代参数合成相应的Statement对象，查询缓存（缓存有直接返回，没有才会执行SQL），发送SQL得到结果，通过resultMap节点映射信息和数据库的元信息将结果集封装到JavaBean或JavaBeanList，返回结果，提交事务，将连接对象返回给连接池。<br> 主要过程就是这样，中间很复杂的处理细节还是去看源码就懂啦~</span></p> 
<p><span style="font-family:微软雅黑;">参考文档：<br> <a href="http://blog.csdn.net/fansunion/article/details/8254855" target="_blank" rel="external">http://blog.csdn.net/fansunion/article/details/8254855</a> 这个有好多篇，一直点下一篇即可看，粗略了解一下Mybatis<br> &nbsp;<a href="http://www.mybatis.org/mybatis-3/zh/" target="_blank" rel="external">http://www.mybatis.org/mybatis-3/zh/</a> 官方文档<br> &nbsp;<a href="https://github.com/Coselding/mybatis-3" target="_blank" rel="external">https://github.com/Coselding/mybatis-3</a> github仓库</span></p>
                <p>本文为博主原创，允许转载，但请声明原文地址：<a href="http://www.coselding.cn/article/2016-06-09/-1151499729.html" target="_blank" rel="external">http://www.coselding.cn/article/2016-06-09/-1151499729.html</a></p>
                </div>

                <div class="panel-body">
                    <div>
                        <a id="looked" href="#"><span class="glyphicon glyphicon-eye-open"></span> 327 已阅</a>
                        &nbsp;&nbsp;
                        <a id="likes" href="javascript:like('/like?artid=172')" target="_blank" rel="external">
                            <span class="glyphicon glyphicon-heart-empty"></span> 12 喜爱
                        </a>
                        &nbsp;&nbsp;
                        <a class="comment-btn" href="javascript:onComment('/comment','MyBatis源码浅析','172')" target="_blank" rel="external"><span class="glyphicon glyphicon-comment"></span> 给我留言</a>
                    </div>
                </div>
                <div class="panel-body">
                    <div class="text-left">
                        <a href="/article/2016-05-31/-8428325.html" title="上一篇">
                            &laquo;Hadoop 2.x HDFS使用和配置步骤
                        </a>
                    </div>
                    <div class="text-right">
                        <a href="/article/2016-06-28/gonggao.html" title="下一篇">
                            公告&raquo;
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-3 column">

            <div class="panel panel-info">
                <div class="panel-heading">
                    <h3 class="panel-title"><span class="glyphicon glyphicon-bullhorn"></span>&nbsp; 最近更新</h3>
                </div>

                <ul id="last3" class="list-group">
                    <li class="list-group-item">
                        <div class="list-group-item-heading text-left">
                            <h5><a href="/article/2016-12-15/IntelliJ-IDEA-license-server-build.html">IntelliJ IDEA license server服务器搭建</a></h5>
                        </div>
                        <div class="list-group-item-text text-right">
                            <em>2016-12-15 20:28</em>
                        </div>
                    </li>
                    <li class="list-group-item">
                        <div class="list-group-item-heading text-left">
                            <h5><a href="/article/2016-12-01/APNs-study-and-use.html">APNs入门学习和使用</a></h5>
                        </div>
                        <div class="list-group-item-text text-right">
                            <em>2016-12-01 04:29</em>
                        </div>
                    </li>
                    <li class="list-group-item">
                        <div class="list-group-item-heading text-left">
                            <h5><a href="/article/2016-12-01/Pushy-readme-translation.html">Pushy入门文档中文翻译</a></h5>
                        </div>
                        <div class="list-group-item-text text-right">
                            <em>2016-12-01 04:14</em>
                        </div>
                    </li>

                    <li class="list-group-item text-center">
                        <a href="/list">more</a>
                    </li>
                </ul>
            </div>

            <div class="panel panel-info">
                <div class="panel-heading">
                    <h5 class="text-left"><span class="glyphicon glyphicon-search"></span> &nbsp;搜索文章</h5>
                </div>
                <div class="panel-body">
                    <form role="form" method="post" action="/search">
                        <div class="form-group">
                            <input class="form-control" type="text" name="key" value="输入关键字搜索博客..." onfocus="this.value=''" onblur="this.value='输入关键字搜索博客...'">
                        </div>
                    </form>
                </div>
            </div>

            <div class="panel panel-info">
                <div class="panel-heading">
                    <h3 class="panel-title"><span class="glyphicon glyphicon-tags"></span> &nbsp;标签</h3>
                </div>

                <ul id="categories" class="list-group">
                    <li class="list-group-item"><a href="/list?cid=2">Android(12)</a></li>
                    <li class="list-group-item"><a href="/list?cid=11">Hadoop和云计算(8)</a></li>
                    <li class="list-group-item"><a href="/list?cid=12">iOS相关(2)</a></li>
                    <li class="list-group-item"><a href="/list?cid=5">JavaEE(12)</a></li>
                    <li class="list-group-item"><a href="/list?cid=3">JavaSE(3)</a></li>
                    <li class="list-group-item"><a href="/list?cid=9">个人心得(5)</a></li>
                    <li class="list-group-item"><a href="/list?cid=7">前端(4)</a></li>
                    <li class="list-group-item"><a href="/list?cid=6">基础知识(6)</a></li>
                    <li class="list-group-item"><a href="/list?cid=10">数据库(1)</a></li>
                    <li class="list-group-item"><a href="/list?cid=8">框架相关(16)</a></li>
                    <li class="list-group-item"><a href="/list?cid=4">项目相关(5)</a></li>
                </ul>
            </div>

            <div class="panel panel-info">
                <div class="panel-heading">
                    <h3 class="panel-title"><span class="glyphicon glyphicon-link"></span> &nbsp;友情链接</h3>
                </div>
                <ul class="list-group">
                    <li class="list-group-item"><a href="https://www.zning.net.cn" target="_blank" rel="external">张宁网</a></li>
                    <li class="list-group-item"><a href="https://cloudups.github.io" target="_blank" rel="external">凌云阁</a></li>
                    <li class="list-group-item"><a href="https://noahzu.github.io" target="_blank" rel="external">Android资源开发小栈</a></li>
                    <li class="list-group-item"><a href="https://heinika.github.io/" target="_blank" rel="external">陈利津</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>

<footer class="panel-footer">
    <div class="container">
        <div class="row clearfix text-center">
            <a href="/s/">短网址</a>&nbsp;&nbsp;
            <a href="/WorkUpload/">作业提交系统</a>&nbsp;&nbsp;
            <!--<a href="/uShare/">uShare</a>&nbsp;&nbsp;-->
            <!--<a href="/smartor/">Smartor</a>&nbsp;&nbsp;-->
            <!--<a href="/PlaneWar/">飞机大战</a>-->
        </div>
        <div class="row clearfix text-center">
            <div class="copyright">
                Copyright &copy;2016.Coselding &nbsp; All rights reserved.<a href="http://www.miitbeian.gov.cn" target="_blank" rel="external">鲁ICP备15036981号-2</a>
            </div>

            <div class="netsupervisor-div">
                <a class="netsupervisor-a" target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=37021002000115">
                    <img src="/images/beian.png" class="netsupervisor-image">
                    <p class="netsupervisor-text">鲁公网安备
                        37021002000115号</p>
                </a>
            </div>
        </div>
    </div>
</footer>
</body>
<script type="text/javascript" src="/js/scripts.js"></script>
<script type="text/javascript">
    $(function(){//网页加载完成执行
        refreshLookedAndLikes('/refresh?artid=172');
        refreshLast3Articles('/last3','');
        refreshCategories('/categories','');
    });
</script>
</html></div></div><div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div><script>var cloudTieConfig = {
  url: document.location.href,
  productKey: "8c4e8416431747c595ded338559ffe2e",
  target: "cloud-tie-wrapper"
};</script><script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016-12-05/校招之路/">校招之路</a></li><li class="post-list-item"><a class="post-list-link" href="/2016-12-05/Solr6.5.1集群部署和后台管理/">Solr 6.5.1集群部署和后台管理</a></li><li class="post-list-item"><a class="post-list-link" href="/2016-12-05/hello-world/">Hello World</a></li></ul></div><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Hello/">Hello</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/个人心得/">个人心得</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/hello/" style="font-size: 15px;">hello</a> <a href="/tags/init/" style="font-size: 15px;">init</a> <a href="/tags/个人心得/" style="font-size: 15px;">个人心得</a> <a href="/tags/面试/" style="font-size: 15px;">面试</a> <a href="/tags/校招/" style="font-size: 15px;">校招</a> <a href="/tags/搜索引擎/" style="font-size: 15px;">搜索引擎</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/solr/" style="font-size: 15px;">solr</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://www.zning.net.cn" title="张宁网" target="_blank">张宁网</a><ul></ul><a href="https://cloudups.github.io" title="凌云阁" target="_blank">凌云阁</a><ul></ul><a href="https://noahzu.github.io" title="Android资源开发小栈" target="_blank">Android资源开发小栈</a><ul></ul><a href="https://heinika.github.io/" title="陈利津" target="_blank">陈利津</a><ul></ul><a href="http://www.itfenghui.com/" title="SEO" target="_blank">SEO</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">Coselding.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?5f2780e77f78ddb4e621d840e6d71d90";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>